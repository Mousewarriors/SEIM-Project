scenario:
  id: SCN-012
  name: Phish → XLL Add-in Persistence → Beaconing → Credential Dump
  difficulty: intermediate
  estimated_time_minutes: 75
  deep_scenario: true
alert:
  id: ALT-012
  title: Office Add-in Persistence Suspected (Excel → PowerShell → XLL)
  severity: critical
  category: malware_execution
  status: open
  created_at: '2024-12-07T08:32:30Z'
  host: WKSTN-022
  user: asmith
  description: >-
    Phishing attachment led to XLL download, registry persistence, TLS
    beaconing, and suspected credential dump activity.
iocs:
  ips:
    - 185.128.27.44
  domains:
    - office-addin-support.com
  urls:
    - https://office-addin-support.com/assets/ExcelTools.xll
  hashes:
    - b2c3d4e5f60718293a4b5c6d7e8f90123456789abcdef0123456789abcdef0a
    - a1b2c3d4e5f60718293a4b5c6d7e8f90123456789abcdef0123456789abcdef0
    - c3d4e5f60718293a4b5c6d7e8f90123456789abcdef0123456789abcdef0ab
playbook:
  name: Office Add-in Persistence / Credential Access Triage
  steps:
    - >-
      Review email authentication failures and attachment details; capture
      sender/URLs/hashes.
    - >-
      Confirm Office parent-child chain (Excel → PowerShell) and download
      destination.
    - Validate XLL file hash and persistence (Excel Options/OPEN registry).
    - Analyze outbound DNS/TLS patterns for beaconing and identify C2 endpoints.
    - >-
      Investigate credential access attempts (LSASS dump) and any exfiltration
      volume.
    - >-
      Containment: isolate host, remove add-in persistence, reset creds, block
      IOCs, hunt for same add-in across estate.
scoring:
  required_actions:
    - identify_phish_attachment
    - confirm_xll_persistence
    - extract_c2_iocs
    - identify_credential_dump
    - confirm_exfil
    - recommend_isolation_and_reset
  max_score: 100
events_ref:
  events_file_jsonl: data/SCN-012.events.jsonl
  events_file_csv: data/SCN-012.events.csv
  zeek_dir: data/zeek/SCN-012/
answer:
  verdict: true_positive
  severity: critical
  summary: >-
    Investigation confirms the alert 'Office Add-in Persistence Suspected (Excel
    → PowerShell → XLL)'. Analysis reveals suspicious activity.
  key_findings:
    - Identify Phish Attachment
    - Confirm Xll Persistence
    - Extract C2 Iocs
    - Identify Credential Dump
    - Confirm Exfil
    - Recommend Isolation And Reset
  recommended_action: escalate
  containment_required: true
